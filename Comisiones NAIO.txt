DECLARE @FECHAINCIAL DATE =  '2025-01-01';
DECLARE @FECHAFINAL DATE = '2025-01-21';

SELECT DAY(ESTAD_HIS.FECHA) AS FECHA,EMPRESAS.NIT_EMP AS OWNER,EMPRESAS.NOMBRE_EMP AS RAZON_SOCIAL,
DATEDIFF(DAY, REGISTRO.FLLEGA_REG, REGISTRO.FSALID_REG) AS NOCHES,ESTAD_HIS.VALORHAB AS INGRESOS,
MONTH(FECHA) AS MES,REGISTRO.FLLEGA_REG,REGISTRO.FSALID_REG ,'' AS ESTADO,'NAIO' AS HOTEL
FROM ESTAD_HIS
INNER JOIN EMPRESAS ON ESTAD_HIS.CODIGA_AGE = EMPRESAS.CODIGE_EMP
LEFT JOIN CIUDAD ON EMPRESAS.CODCIUD = CIUDAD.CODCIUD 
LEFT JOIN PAIS ON PAIS.CODPAIS = CIUDAD.CODPAIS
LEFT JOIN REGISTRO ON REGISTRO.REGISTRO = ESTAD_HIS.REGISTRO 
WHERE ESTAD_HIS.ADULTOS > 0 AND ESTAD_HIS.FECHA BETWEEN CONVERT(SMALLDATETIME, @FECHAINCIAL, 120) AND CONVERT(SMALLDATETIME, @FECHAFINAL, 120)
GROUP BY EMPRESAS.NOMBRE_EMP,FECHA,EMPRESAS.DIRECC_EMP,CIUDAD.NOMCIUD,PAIS.NOMPAIS,NIT_EMP,
EMPRESAS.CODIGE_EMP,EMPRESAS.TELEF_EMP, REGISTRO.FLLEGA_REG,REGISTRO.FSALID_REG,ESTAD_HIS.VALORHAB

UNION

SELECT DAY(ESTAD_HIS.FECHA) AS FECHA,AGENCIAS.NIT_AGE AS OWNER,AGENCIAS.NOMBRE_AGE AS RAZON_SOCIAL,
DATEDIFF(DAY, REGISTRO.FLLEGA_REG, REGISTRO.FSALID_REG) AS NOCHES,ESTAD_HIS.VALORHAB AS INGRESOS,
MONTH(FECHA) AS MES,REGISTRO.FLLEGA_REG,REGISTRO.FSALID_REG,'' AS ESTADO,'COCO' AS HOTEL
FROM ESTAD_HIS
INNER JOIN AGENCIAS ON ESTAD_HIS.CODIGA_AGE = AGENCIAS.CODIGA_AGE
LEFT JOIN CIUDAD ON AGENCIAS.CODCIUD = CIUDAD.CODCIUD 
LEFT JOIN PAIS ON PAIS.CODPAIS = CIUDAD.CODPAIS
LEFT JOIN REGISTRO ON REGISTRO.REGISTRO = ESTAD_HIS.REGISTRO 
WHERE ESTAD_HIS.ADULTOS > 0 AND ESTAD_HIS.FECHA BETWEEN CONVERT(SMALLDATETIME, @FECHAINCIAL, 120) AND CONVERT(SMALLDATETIME, @FECHAFINAL, 120)
GROUP BY AGENCIAS.NOMBRE_AGE,FECHA,CIUDAD.NOMCIUD,PAIS.NOMPAIS,AGENCIAS.NIT_AGE,
AGENCIAS.CODIGA_AGE,AGENCIAS.TELEF_AGE, REGISTRO.FLLEGA_REG,REGISTRO.FSALID_REG,ESTAD_HIS.VALORHAB